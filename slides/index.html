<!doctype html>
<html lang="en">
   <head>
      <meta charset="utf-8">
      <title>Workshop - Building Java apps with Gradle</title>
      <meta name="description" content="Java">
      <meta name="author" content="Morten Weel Johnsen">
      <meta name="apple-mobile-web-app-capable" content="yes" />
      <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
      <link rel="stylesheet" href="css/reveal.min.css">
      <link rel="stylesheet" href="css/theme/iterate.css" id="theme">
      <!-- For syntax highlighting -->
      <link rel="stylesheet" href="lib/css/github.css">
      <!-- If the query includes 'print-pdf', use the PDF print sheet -->
      <script>
         document.write( '<link rel="stylesheet" href="css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
      </script>
      <!--[if lt IE 9]>
      <script src="lib/js/html5shiv.js"></script>
      <![endif]-->
   </head>
   <body>
      <div class="reveal">
         <!-- Any section element inside of this container is displayed as a slide -->
         <div class="slides">
            <section data-state="inverted">
               <h2>Workshop</h2>
               <h3>Let Gradle build your Java apps</h3>
               <small>github.com/weel/gradle-java-workshop</small>
               <br/>
               <a href="#">
               <img width="300" height="300" src="http://imgs.xkcd.com/comics/compiling.png">
               </a>
               <br/>
               <small>Morten Weel Johnsen</small>
            </section>
            <!-- Slide  - Expected outcome -->
            <section>
               <h3>About</h3>
               <br/>
               <ul>
                  <li class="fragment">Developer at Iterate</li>
                  <li class="fragment">Android, Java, Frontend/backend developement</li>
                  <li class="fragment">Migrated from Maven/Ant/Make to gradle</li>
               </ul>
            </section>
           
            <section>
               <h3>Expected outcome?</h3>
               <br/>
               <h4 class="fragment">Be able to ...</h4>
               <ul>
                  <li class="fragment">Build java applications with Gradle</li>
                  <li class="fragment">Migrate from Maven to Gradle</li>
               </ul>
            </section>
            <!-- Slide  - Agenda -->
            <section>
               <h3>Agenda</h3>
               <ul>
                  <li class="fragment">Motivation & Background</li>
                  <li class="fragment">Maven vs Gradle</li>
                  <li class="fragment">Gradle Intro</li>
                  <li class="fragment">Build Java Webapps with Gradle</li>
                  <li class="fragment">Migrating from Maven to Gradle</li>
                  <li class="fragment">Bonus</li>
               </ul>
            </section>
            <!-- Slide  - Comparison of popularity -->
            <section>
               <a href="#">
               <img  src="http://zeroturnaround.com/wp-content/uploads/2014/01/build-tools-popularity-2010-to-2013.jpg">
               </a>
            </section>
            <!-- Slide  - Why choose gradle over Maven -->
            <section>
               <h3>Why choose Gradle over Maven</h3>
               <ul>
                  <li class="fragment">DSL instead of XML</li>
                  <li class="fragment">Documentation is awesome</li>
                  <li class="fragment">Both uses maven repository</li>
                  <li class="fragment">No boilerplate</li>
                  <li class="fragment">Convention over configuration</li>
                  <li class="fragment">Gradle Wrapper</li>
                  <li class="fragment">Gradle Daemon for faster builds</li>
                  <li class="fragment">Better multi-module project support</li>
               </ul>
            </section>

              <section>
               <h3>Gradle</h3>
               <ul>
                  <li class="fragment">Groovy</li>
                  <li class="fragment">Gradle 1.0 released in 2012</li>
                  <li class="fragment">Latest version 2.1</li>
                  </ul>
            </section>
            <!-- Slide  - Getting started with gradle -->
            <section>
               <h3>Task 1 - Getting started</h3>
               <ol>
                  <li class="fragment">Download from http://www.gradle.org/ (version 2.1)</li>
                  <li class="fragment">Install gradle & add to path</li>
                  <li class="fragment">Run 'gradle init' in an empty folder </li>
                  <li class="fragment">Run 'gradle tasks' to get a list of all tasks available</li>
           
                  <li class="fragment"> git clone git@github.com:weel/gradle-javazone-workshop.git</li>
               
              
               </ol>
            </section>
            <!-- Slide  - Projects and tasks -->
            <section>
               <h3>Projects and tasks</h3>
               <small>Everything in Gradle sits on top of two basic concepts: projects and tasks</small>
               <ul>
                  <li class="fragment">Each project maps one-to-one to a build.gradle file</li>
               </ul>
            </section>
            <!-- Slide  - Gradle tasks -->
            <section>
               <h3>Gradle Tasks</h3>
               <a href="http://www.gradle.org/docs/current/dsl/org.gradle.api.Task.html">Documentation</a>
               <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
task copyPoems(type: Copy) {
  from 'text-files'
  into 'build/poems'
}          </code></pre>
            </section>
   <section>
               <h3>Gradle Tasks II - Dependencies</h3>
               <a href="http://www.gradle.org/docs/current/dsl/org.gradle.api.Task.html">Documentation</a>
               <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
task taskX << {
    println 'taskX'
}

task taskY << {
    println 'taskY'
}

taskX.dependsOn taskY
</code></pre>
            </section>
 <section>
               <h3>Task 2.1 - Gradle tasks</h3>
               <ol>
                  <li class="fragment">Create a task that prints Hello World</li>
                  <li class="fragment">Create a task that copies files from a folder into build folder</li>
                  <li class="fragment">Create a task that list the files in a folder</li>
                  <li class="fragment">Create two tasks that uses task dependencies to print Hello World</li>
               </ol>
            </section>
           

            <!-- Slide  - Gradle plugins -->
            <section>
               <h3>Gradle Plugins</h3>
               <a href="http://www.gradle.org/plugins">Documentation</a>
               <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
apply plugin: 'java'

#Other common plugins: android, jetty, maven +++
</code></pre>
            </section>
<section>
               <h3>Task 2.2 - Gradle plugins</h3>
               <ol>
                  <li class="fragment">Apply plugins and run gradle tasks</li>
                  <li class="fragment">Interesting plugins: application, java, jetty, idea, eclipse</li>
               </ol>
            </section>

            <section>
               <h3>Maven vs Gradle dependencies</h3>
               <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
       <dependency>
    <groupId>com.google.guava</groupId>
    <artifactId>guava</artifactId>
    <version>16.0.1</version>
</dependency>


compile 'com.google.guava:guava:16.0.1'
# Or
compile group:'com.google.guava' name: 'guava' version: '16.0.1'
       </code></pre>
            </section>

                        <!-- Slide  - Gradle structure -->
            <section>
               <h2>Gradle structure</h2>
               <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
application/
└── build.gradle       # Contains build script
└── gradlew            # Downloads gradle
└── wrapper
    ├── gradle-wrapper.jar
    └── gradle-wrapper.properties
          </code></pre>
            </section>
            <!-- Slide  - Minimal gradle -->
            <section>
               <h2>Minimal Gradle #1</h2>
               <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
# empty build.gradle
  </code></pre>
            </section>
            <!-- Slide  - Minimal gradle 2  -->
            <section>
               <h2>Minimal Gradle #2</h2>
               <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
# build.gradle
apply plugin:'java'

group = 'no.gradlejavazone.samples'
version = '1.0.0'
description = "Samples"

sourceCompatibility = 1.8
targetCompatibility = 1.8

repositories {
     maven { url "http://repo.maven.apache.org/maven2" }
}

dependencies {
    compile group: 'org.hibernate', name: 'hibernate', version:'3.1.0'
    compile 'org.hibernate:hibernate-core:3.6.7'
}

  </code></pre>
            </section>

            <section>
               <h3>The Java plugin</h3>
               <a href="http://www.gradle.org/docs/current/userguide/img/javaPluginTasks.png"><img width="1250" height="329" src="http://www.gradle.org/docs/current/userguide/img/javaPluginTasks.png"></a>
            </section>
            <section>
               <h3>Archetypes</h3>
               <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
gradle init --type java-library
       </code></pre>
            </section>
            <!-- Slide  - Java plugin, directory structure -->
            <section>
               <div class="table">
                  <p class="title"><b>Table&nbsp;23.4.&nbsp;Java plugin - default project layout</b></p>
                  <div class="table-contents">
                     <table id="javalayout">
                        <thead>
                           <tr>
                              <td>Directory</td>
                              <td></td>
                              <td>Meaning</td>
                           </tr>
                        </thead>
                        <tbody>
                           <tr>
                              <td>
                                 <code class="filename">src/main/java</code>
                              </td>
                              <td></td>
                              <td>Production Java source</td>
                           </tr>
                           <tr>
                              <td>
                                 <code class="filename">src/main/resources</code>
                              </td>
                              <td></td>
                              <td>Production resources</td>
                           </tr>
                           <tr>
                              <td>
                                 <code class="filename">src/test/java</code>
                              </td>
                              <td></td>
                              <td>Test Java source</td>
                           </tr>
                           <tr>
                              <td>
                                 <code class="filename">src/test/resources</code>
                              </td>
                              <td></td>
                              <td>Test resources</td>
                           </tr>
                           <tr>
                              <td>
                                 <code class="filename">src/<em class="replaceable"><code>sourceSet</code></em>/java</code>
                              </td>
                              <td></td>
                              <td>Java source for the given source set</td>
                           </tr>
                           <tr>
                              <td>
                                 <code class="filename">src/<em class="replaceable"><code>sourceSet</code></em>/resources</code>
                              </td>
                              <td></td>
                              <td>Resources for the given source set</td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
               </div>
            </section>
            <!-- Slide  - dependencies -->
       

                <section>
               <h3>Task 3 - Running a simple junit testcase</h3>
               <ol>
                  <li class="fragment">Create an empty build.gradle file</li>
                  <li class="fragment">Add dependency for latest junit version</li>
                  <li class="fragment">Create a Junit test in src/test/java/</li>
                  <li class="fragment">Run tests</li>
               </ol>
            </section>

           <section>
               <h3>Task 4 - Running a simple Java application - Tutorial</h3>
               <ol>
                  <li class="fragment">Apply plugin 'application'</li>
                  <li class="fragment">Create a java file in src/main/java with a main method</li>
                  <li class="fragment">Make java application print Hello JavaZone</li>
                  <li class="fragment">Run</li>
               </ol>
            </section>


            <section>
               <h2>Defining Main-class attribute</h2>
               <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">

jar {
    manifest {
        attributes 'Main-Class': 'no.weel.javazone.HelloWorld'
    }
}
  </code></pre>
            </section>

            <!-- Slide  - Gradle ShadowJar -->
            <section>
               <h3>Gradle ShadowJar plugin</h3>
    <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
shadowJar {
  mergeServiceFiles {
    exclude 'META-INF/*.*SA'
  }
}
 </code></pre>
            </section>

              <section>
               <h3>Task 5.1 - Migrating from Maven to Gradle manually </h3>
               <ol>
                  <li class="fragment">Based on simple REST example Restify</li>
               </ol>
            </section>

              <section>
               <h3>Task 5.2 - Migrating from Maven to Gradle using migrating tool</h3>
                <ol>
                  <li class="fragment">Based on simple REST example Restify</li>
               </ol>
     
            </section>

              <section>
               <h3>Task 6 - Migrating from Maven to Gradle using migrating tool</h3>
                <ol>
                  <li class="fragment">Based on dropwizard-example</li>
               </ol>
     
            </section>


            <!-- Slide  - Gradle wrapper -->
            <section>
               <h2>Gradle Wrapper</h2>
               <p>Minimal wrapper to download and use specified Gradle version.</p>
               <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
./gradlew tasks  # Downloads gradle and runs command to show tasks
          </code></pre>
            </section>
         
            <section>
               <h2>Get started from terminal</h2>
               <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
$ ./gradlew tasks   # Lists all tasks available

$ ./gradlew jettyRun   # Builds and run on jetty

$ ./gradlew jettyRunWar  # Builds and run war on jetty

$ ./gradlew build

        </code></pre>
            </section>
            <section>
               <h2>Bonus</h2>
               <br/>
               <a href="http://www.gradle.org/learn">http://www.gradle.org/learn</a>
            </section>
            <section>
               <h2>Gradle daemon</h2>
               <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
# Add to gradle.properties in folder ~/.gradle

org.gradle.daemon=true

or start with
gradle --daemon

          </code>
          </pre>
            </section>
   <section>
               <h2>Incremental builds</h2>
                  <ol>
                  <li class="fragment">Reduced compilation time during development due to less files being compiled</li>
                  <li class="fragment">Class files whose content is unchanged by a compile are not updated on the filesystem</li>
               </ol>
             </section>

            <section>
               <h2>Encoding UTF-8</h2>
               <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
                 
allprojects {
    tasks.withType(JavaCompile) {
        options.incremental = true
    }
}
        </code></pre>
            </section>

            <section>
               <h2>Encoding UTF-8</h2>
               <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
#For specific task compileJava

compileJava.options.encoding = 'UTF-8'

# or for all compile tasks
        apply plugin: 'java'

tasks.withType(Compile) {
    options.encoding = 'UTF-8'
}
        </code></pre>
            </section>

                  <section>
      <h2>Publishing artifacts</h2>
          <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
          
apply plugin: 'java'
apply plugin: 'maven'

group = 'com.gradleware.samples'

uploadArchives {
    repositories.mavenDeployer {
        repository(url: "https://mavenrepository.com")
    }
}
        </code></pre>
      
        </section>

            <section>
               <h2>Profiling</h2>
               <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
$ gradle --profile build

        </code></pre>
               <img src="http://4.bp.blogspot.com/_-vJw6r2W-bw/TOWZ-RYtrMI/AAAAAAAAEHg/oy1akB42uRk/s640/Screen+shot+2010-11-18+at+10.19.57+PM.png">
            </section>

            <section><h3>Autocompletion in bash</h3>
              https://gist.github.com/nolanlawson/8694399
              </section>
            <section>
            
            <section><h3>IDE support</h3>
              </section>
     <h2>Defining variables</h2>
          <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
          
def helloName = "JavaZone"
int personAge = 40 

task hello << {
    println "Hello ${helloName}. I believe you are ${personAge} years of age."
}

        </code></pre>
      
 
            <section>
               <h2>Questions?</h2>
               <small>Leave feedback: http://bit.ly/gradle-feedback</small>
               <br/>
            </section>

            <section>   

               <h3>Master your tool</h3>
               <blockquote>
                  “I’ve known people who have not mastered their tools who are good programmers, but not a tool master who remained a mediocre programmer.” – Kent Beck
               </blockquote>
            </section>
         </div>
      </div>
      <script src="lib/js/head.min.js"></script>
      <script src="js/reveal.min.js"></script>
      <script>
         Reveal.initialize({
           controls: false,
           progress: true,
           history: true,
           center: true,
           rollingLinks: false,
         
           theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
           transition: Reveal.getQueryHash().transition || 'linear', // default/cube/page/concave/zoom/linear/fade/none
         
           // Optional libraries used to extend on reveal.js
           dependencies: [
             { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
             { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
             { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
             { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
             { src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
             { src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
           ]
         });
         
      </script>
   </body>
</html>